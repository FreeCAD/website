{{- /* Title */ -}}
{{- $pageTitle := site.Title -}}
{{- if (and .Title (not .IsHome)) -}}
  {{- $pageTitle = printf "%s | %s" $pageTitle .Title -}}
{{- end -}}

{{- /* Description */ -}}
{{- $description := "" -}}
{{- with .Description -}}
  {{ $description = . }}
{{- else with or .IsPage .IsSection -}}
  {{ $description = $.Summary }}
{{- else with site.Params.description -}}
  {{ $description = . }}
{{- end -}}

{{- /* Meta */ -}}
{{- $keywords := slice -}}
{{- with .Params.tags -}}
  {{- $keywords = delimit .  ", " -}}
{{- end -}}
{{- if .IsHome  -}}
  {{- with site.Params.keywords -}}
    {{- $keywords = delimit .  ", " -}}
  {{- end -}}
{{- end -}}

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="
{{- if hugo.IsProduction | or (eq site.Params.env "production") -}}
  index, follow
{{- else -}}
  noindex, nofollow
{{- end -}}">

<title>
  {{ $pageTitle | plainify }}
</title>
<meta name="description" content="{{ $description | default $pageTitle | plainify }}">
<meta name="keywords" content="{{- $keywords | default $pageTitle -}}">
<meta name="author" content="{{ (partial "author.html" . ) }}">
<link rel="canonical" href="{{ .Permalink }}">

{{- partialCached "styles.html" . -}}

{{- /* Favicons */ -}}
<link rel="icon" href="{{ "favicon.ico" | absURL }}">
<link rel="apple-touch-icon" href="{{ "apple-touch-icon.png" | absURL }}">

{{- range .AllTranslations -}}
  <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
{{- end -}}

{{- /* Misc */ -}}
{{- if hugo.IsProduction | or (eq site.Params.env "production") -}}
  {{- if site.Config.Services.GoogleAnalytics.ID -}}
    {{- partial "google_analytics.html" . -}}
  {{- end -}}
{{- end -}}

{{- partial "opengraph.html" . -}}

{{- partial "theme_toggle.html" . -}}
