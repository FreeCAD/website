{{- define "main" -}}

{{- if not hugo.IsProduction -}}
  {{- partial "debug.html" . -}}
{{- end -}}

{{- partial "hero.html" . -}}

{{/* get the latest news articles by category except the ones with "hero" parameters in front matter */}}
{{- $pages := slice -}}
{{- with site.Sites.Default -}}
  {{- range .Taxonomies.categories.ByCount -}}
    {{- range first 1 (where .Pages "Params.hero" "ne" true) -}}
      {{- $pages = $pages | append . -}}
    {{- end -}}
  {{- end -}}
{{- end -}}
{{- $pages = first (.Params.paginate | default 6) $pages -}}

<section class="articles">
  {{- range $index, $page := $pages -}}
    {{- partial "article_card.html" . -}}
  {{- end -}}
</section>

{{- with (index (where (.RegularPages | lang.Merge site.Sites.Default.RegularPages) "Type" "homepage") 0) -}}
  {{- partial "content.html" . -}}
{{- end -}}

{{- end -}}
{{/* End main. */}}
