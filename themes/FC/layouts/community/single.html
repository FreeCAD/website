{{- define "main" -}}

{{- if not hugo.IsProduction -}}
  {{- partial "debug.html" . -}}
{{- end -}}

<header>
  <h1 class="title">
    {{ .Title | .RenderString }}
    {{- if .Draft -}}
      <sup><span class="entry-isdraft">[{{- i18n "draft" | default "Draft" -}}]</span></sup>
    {{- end -}}
  </h1>

  {{- if .Description -}}
    <h3 class="description">
      {{ .Description | .RenderString }}
    </h3>
  {{- end -}}

  {{- with .Params.cards -}}
    {{- partial "hero_cards.html" . -}}
  {{- end -}}

  {{- partial "calendar.html" . -}}

  {{- partial "hero_cover.html" . -}}
</header>

{{/* Get the Table Of Contents. */}}
{{- if .Params.ToC -}}
  {{ .TableOfContents }}
{{- end -}}

{{/* Get latest event articles. */}}
{{- $pages := where .RegularPages "Section" "news" | lang.Merge (where site.Sites.Default.RegularPages "Section" "news") -}}
{{- $events := where $pages "Params.categories" "in" "event" -}}
{{- $latest := first 3 (sort $events "Date" "desc") -}}

{{- with $latest -}}
  <section class="articles">
    {{- range . -}}
      {{- partial "article_card.html" . -}}
    {{- end -}}
  </section>
{{- end -}}

{{/* Get the content of a Page. */}}
{{- partial "content.html" . -}}

{{- end -}}
{{/* end main */}}
