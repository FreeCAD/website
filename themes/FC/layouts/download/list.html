{{- define "main" -}}

{{- if not hugo.IsProduction -}}
  {{- partial "debug.html" . -}}
{{- end -}}

{{- $latest_release := index (where site.RegularPages "Type" "releases") 0 | default (index (where site.Sites.Default.RegularPages "Type" "releases") 0) -}}

<header>
  {{- if .Description -}}
    <h1 class="title">
      {{ .Description | .RenderString }}
    </h1>
  {{- end -}}

  {{- if and .Params.subtitle $latest_release.Params.version -}}
    <h3 class="description">
      {{ .Params.subtitle | .RenderString }}: {{ $latest_release.Params.version }}
    </h3>
  {{- end -}}

  {{/* Call the release partial to provide download links from the latest release. */}}
  {{- with $latest_release -}}
    {{- partial "release.html" . -}}
    {{- if .Title -}}
      <a class="release-button" href="{{ .RelPermalink }}" alt="{{ upper .Title -}} RELEASE"
        aria-label="{{ .Title }} {{ i18n "release_notes" | default "Release Notes" }}">
        {{ printf "%s %s Â· " .Title (i18n "release_notes" | default "Release Notes") }}
        {{- with .Date -}}
          <time datetime="{{ . }}" class="date">
            {{ . | time.Format ":date_long" }}
          </time>
        {{- else -}}
          {{- print "Release Date is falsy" -}}
        {{- end -}}
      </a>
    {{- else -}}
      {{- print "Release Title is falsy" -}}
    {{- end -}}
  {{- end -}}

  {{- partial "hero_cover.html" . -}}
</header>

{{/* Get Table Of Contents. */}}
{{- if .Params.ToC -}}
  {{ .TableOfContents }}
{{- end -}}

{{- partial "content.html" . -}}

{{- end -}}
{{/* End main. */}}