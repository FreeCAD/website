{{- /* Paginate current Section:
     - Provide links to Previous and Next pages in Section.
     - Fallback to default language Site if missing. */ -}}

{{- $section := .CurrentSection -}}
{{- $pages := $section.RegularPages
  | lang.Merge (where site.Sites.Default.RegularPages "CurrentSection.Path" "eq" $section.Path) -}}

{{- /* Reverse sort order if set in Front Matter. */ -}}
{{- if eq .Params.pageSortOrder "reverse" -}}
  {{- $pages = $pages.Reverse -}}
{{- end -}}

{{- if $pages -}}
  {{- $pageNumber := 0 -}}
  {{- range $index, $page := $pages -}}
    {{- if eq $page.File.Path $.File.Path -}}
      {{- $pageNumber = add $index 1 -}}
    {{- end -}}
  {{- end -}}
  {{- $totalPages := len $pages -}}

  <footer class="single-footer">
    <nav class="pagination">
      {{- with $pages.Prev . -}}
        <a class="prev"
          href="{{ .RelPermalink -}}#top"
          alt="PREVIOUS ARTICLE"
          title="{{ i18n "previous_article" | default "Previous article" }}">
          {{- partial "utils/icon.html" "arrow-left" -}}
          {{- .LinkTitle | .RenderString -}}

          {{- if not (eq .Lang $.Lang) -}}
            {{- partial "utils/icon.html" "translations" -}}
            {{ .Lang | upper -}}
          {{- end -}}

          {{- if not hugo.IsProduction -}}
            {{- with .Weight -}}
              <span style="color: crimson;">Weight: {{ . }}</span>
            {{- end -}}
          {{- end -}}
        </a>
      {{- end -}}

      <p class="page-number">{{ $pageNumber }} / {{ $totalPages }}</p>

      {{- with $pages.Next . -}}
        <a class="next"
          href="{{ .RelPermalink -}}#top"
          alt="NEXT ARTICLE"
          title="{{ i18n "next_article" | default "Next article" }}">
          {{- .LinkTitle | .RenderString -}}

          {{- if not (eq .Lang $.Lang) -}}
            {{- partial "utils/icon.html" "translations" -}}
            {{ .Lang | upper -}}
          {{- end -}}

          {{- partial "utils/icon.html" "arrow-right" -}}

          {{- if not hugo.IsProduction -}}
            {{- with .Weight -}}
              <span style="color: crimson;">Weight: {{ . }}</span>
            {{- end -}}
          {{- end -}}
        </a>
      {{- end -}}
    </nav>
  </footer>
{{- end -}}
