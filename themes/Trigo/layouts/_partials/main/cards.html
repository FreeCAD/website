<div class="card-list">
  <div class="cards">
    {{- range . -}}

      <a class="card"
        href="{{ .RelPermalink }}"
        title="{{ .Title }}">

        {{- /* Get article card cover image. */ -}}
        {{- $cardImage := partial "main/card_image.html" . -}}
        {{- $cardIcon := partial "utils/icon.html" .Params.icon -}}

        {{- with $cardImage -}}
          {{- . -}}
        {{- else with $cardIcon -}}
          <span class="card-icon">
            <span class="icon">{{ . }}</span>
          </span>
        {{- else -}}
          {{- $page := index (.GetTerms "categories") 0 | default . -}}
          {{- $cardCode := partial "utils/index_code.html" $page -}}
          <div class="card-color" style="--card: {{ $cardCode }};"></div>
        {{- end -}}

        <h3 class="card-title">
          {{- .Title -}}
          {{- if .Draft }}
            <sup><span>[{{- i18n "draft" | default "Draft" -}}]</span></sup>
          {{- end -}}
        </h3>

        {{- with .Description -}}
          <p class="card-description">{{- . -}}</p>
        {{- end -}}

        {{- if not hugo.IsProduction -}}
          {{- with .Weight -}}
            <h2 style="color: crimson;">Weight: {{ . }}</h2>
          {{- end -}}
        {{- end -}}

        {{- if and .Date .Params.categories -}}
          <div class="card-metadata">
            {{- if not .Date.IsZero -}}
              <span class="meta">
                {{- with (partial "utils/icon.html" "date") -}}
                  <span class="icon">{{ . }}</span>
                {{- end -}}
                <time datetime="{{ .Date.UTC.Format "2006-01-02T15:04:05Z" }}">
                  {{- .Date | time.Format ":date_long" -}}
                </time>
              </span>
            {{- end -}}

            {{- with index (.GetTerms "categories") 0 -}}
              <span class="meta">
                {{- with (partial "utils/icon.html" "categories") -}}
                  <span class="icon">{{ . }}</span>
                {{- end -}}
                {{ .LinkTitle }}
              </span>
            {{- end -}}
          </div>
        {{- end -}}
      </a>

    {{- end -}}
  </div>
</div>